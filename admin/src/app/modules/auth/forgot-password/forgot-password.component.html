<!--begin::Forgot Password-->
<div class="login-container">
  <div class="login-content">

    <!-- Logo -->
    <div class="text-center mb-10">
      <img src="assets/media/logos/logo-megarys.png" alt="Megarys Logo" class="login-logo" />
    </div>

    <!-- Title -->
    <div class="text-center mb-10">
      <h3 class="login-title">
        ¿Olvidaste tu contraseña?
      </h3>
      <p class="text-muted font-weight-bold">
        Ingresa tu correo para restablecerla
      </p>
    </div>

    <!--begin::Form-->
    <form class="form" novalidate="novalidate" [formGroup]="forgotPasswordForm" (ngSubmit)="submit()"
      id="kt_login_forgot_form" [ngStyle]="{ display: errorState === errorStates.NoError ? 'none' : 'block' }">

      <!-- Alert Error -->
      <ng-container *ngIf="errorState === errorStates.HasError">
        <div class="mb-10 alert alert-custom alert-danger alert-dismissible">
          <div class="alert-text font-weight-bold">El correo ingresado no es correcto.</div>
        </div>
      </ng-container>

      <!-- Email Group -->
      <div class="form-group mb-5">
        <label class="font-size-h6 font-weight-bolder text-dark">Correo Electrónico</label>
        <input class="form-control form-control-solid h-auto py-7 px-6 rounded-lg border-0" type="email" name="email"
          placeholder="admin@megarys.com" formControlName="email"
          [ngClass]="{ 'is-invalid': forgotPasswordForm.controls['email'].invalid && forgotPasswordForm.controls['email'].touched }" />

        <ng-container [ngTemplateOutlet]="formError"
          [ngTemplateOutletContext]="{ validation: 'required', message: 'El correo es requerido', control: forgotPasswordForm.controls['email'] }"></ng-container>
        <ng-container [ngTemplateOutlet]="formError"
          [ngTemplateOutletContext]="{ validation: 'email', message: 'Formato de correo inválido', control: forgotPasswordForm.controls['email'] }"></ng-container>
        <ng-container [ngTemplateOutlet]="formError"
          [ngTemplateOutletContext]="{ validation: 'minLength', message: 'El correo debe tener al menos 3 caracteres', control: forgotPasswordForm.controls['email'] }"></ng-container>
        <ng-container [ngTemplateOutlet]="formError"
          [ngTemplateOutletContext]="{ validation: 'maxLength', message: 'El correo no puede exceder 360 caracteres', control: forgotPasswordForm.controls['email'] }"></ng-container>
      </div>

      <!-- Action -->
      <div class="pb-lg-0 pb-5 text-center d-flex flex-column gap-3">
        <button type="submit" id="kt_login_forgot_submit"
          class="btn btn-megarys-primary font-weight-bolder font-size-h6 px-8 py-4 my-3 w-100"
          [disabled]="forgotPasswordForm.invalid || (isLoading$ | async)">
          <span *ngIf="!(isLoading$ | async)">Enviar Link de Recuperación</span>
          <span *ngIf="isLoading$ | async" class="spinner-border spinner-border-sm align-middle ms-2"></span>
        </button>
        <a routerLink="/auth/login" id="kt_login_forgot_cancel"
          class="btn btn-light-primary font-weight-bolder font-size-h6 px-8 py-4 my-3 w-100 mt-2">
          Cancelar y Volver
        </a>
      </div>
    </form>
    <!--end::Form-->

    <!-- Success Message -->
    <ng-container *ngIf="errorState === errorStates.NoError">
      <div class="card card-custom bgi-no-repeat gutter-b"
        style="height: 175px; background-color: #4ab58e; background-position: calc(100% + 1rem) bottom; background-size: 25% auto; background-image: url(assets/media/svg/humans/custom-1.svg);">
        <!--begin::Body-->
        <div class="card-body d-flex align-items-center">
          <div class="py-2">
            <h3 class="text-white font-weight-bolder mb-3">¡Correo correcto!</h3>
            <p class="text-white font-size-lg">
              Te hemos enviado un mensaje con<br />
              las instrucciones para recuperar tu acceso.<br />
            </p>
            <a routerLink="/auth/login" class="swal2-confirm btn font-weight-bold btn-light-primary mt-3">
              ¡Entendido!
            </a>
          </div>
        </div>
        <!--end::Body-->
      </div>
    </ng-container>

  </div>

  <!-- Footer Copyright -->
  <div class="login-footer">
    <span class="text-muted font-weight-bold mr-2">2026©</span>
    <a href="https://megarys.com" target="_blank" class="text-dark-75 text-hover-primary">Megarys Ecommerce</a>
  </div>
</div>
<!--end::Forgot Password-->

<ng-template #formError let-control="control" let-message="message" let-validation="validation">
  <ng-container *ngIf="control.hasError(validation) && (control.dirty || control.touched)">
    <div class="fv-plugins-message-container">
      <div class="fv-help-block text-danger">
        {{ message }}
      </div>
    </div>
  </ng-container>
</ng-template>