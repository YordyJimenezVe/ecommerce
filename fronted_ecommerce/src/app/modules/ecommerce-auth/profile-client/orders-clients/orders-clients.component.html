<div class="acorder_wrapper">
    <div class="row align-items-center mb-4">
        <div class="col-12">
            <h4 class="text_xl font-weight-bolder" style="color: var(--text-color, #333);">{{ 'Order History' |
                translate }}</h4>
            <p class="text-muted">{{ 'Check the status of your recent orders.' | translate }}</p>
        </div>
    </div>

    <ng-container *ngIf="listOrders.length > 0; else noOrders">
        <ng-container *ngFor="let order of listOrders">
            <div class="single_prof_recorder mb-4 shadow-sm p-4 d-flex flex-wrap align-items-center justify-content-between"
                style="background: var(--bg-color, #fff); border-radius: 12px; border: 1px solid var(--border-color, rgba(0,0,0,0.05)); grid-gap: 15px;">

                <div class="prorder_img d-flex" style="gap: -10px;">
                    <ng-container *ngFor="let item of order.items; let imgIdx = index">
                        <div *ngIf="imgIdx < 3" [style.z-index]="10 - imgIdx"
                            style="width: 60px; height: 60px; border-radius: 8px; border: 2px solid #fff; overflow: hidden; background: #f8f9fa; margin-right: -15px; position: relative; box-shadow: 0 3px 10px rgba(0,0,0,0.1);">
                            <img loading="lazy" [src]="item.imagen" alt="product"
                                style="width: 100%; height: 100%; object-fit: cover;">
                        </div>
                    </ng-container>
                    <div *ngIf="order.items.length > 3"
                        style="width: 60px; height: 60px; border-radius: 8px; border: 2px solid #fff; background: rgba(0,0,0,0.05); display: flex; align-items: center; justify-content: center; position: relative; z-index: 10; font-size: 0.8rem; font-weight: bold; margin-left: -5px; box-shadow: 0 3px 10px rgba(0,0,0,0.1);">
                        +{{ order.items.length - 3 }}
                    </div>
                </div>

                <div class="prorder_txt">
                    <h5 class="text-muted text-uppercase mb-1" style="font-size: 0.75rem; letter-spacing: 1px;">{{
                        'Transaction ID' | translate }}</h5>
                    <p class="font-weight-bold text-dark m-0">{{ order.n_transaccion }}</p>
                </div>

                <div class="prorder_txt">
                    <h5 class="text-muted text-uppercase mb-1" style="font-size: 0.75rem; letter-spacing: 1px;">{{
                        'Date' | translate }}</h5>
                    <p class="m-0 text-dark">{{ order.created_at }}</p>
                </div>

                <div class="prorder_txt d-none d-lg-block text-center">
                    <h5 class="text-muted text-uppercase mb-1" style="font-size: 0.75rem; letter-spacing: 1px;">{{
                        'Items' | translate }}</h5>
                    <span class="badge badge-light px-3 py-2"
                        style="border-radius: 20px; font-size: 0.85rem; border: 1px solid rgba(0,0,0,0.1);">x{{
                        order.cantidad }}</span>
                </div>

                <div class="prorder_txt text-right">
                    <h5 class="text-muted text-uppercase mb-1" style="font-size: 0.75rem; letter-spacing: 1px;">{{
                        'Total' | translate }}</h5>
                    <p class="font-weight-bold m-0 text-primary" style="font-size: 1.1rem;">{{ order.total }} {{
                        order.currency_payment }}</p>
                </div>

                <div class="prorder_txt border-left pl-3" style="min-width: 150px;">
                    <h5 class="text-muted text-uppercase mb-2" style="font-size: 0.75rem; letter-spacing: 1px;">{{
                        'Status & Method' | translate }}</h5>

                    <ng-container *ngIf="order.payment_status == 'PAID_PENDING'">
                        <span class="badge badge-warning text-white px-2 py-1 mb-1 d-inline-block"
                            style="border-radius: 6px;"><i class="las la-clock mr-1"></i> {{ 'Pending Review' |
                            translate }}</span>
                    </ng-container>
                    <ng-container *ngIf="order.payment_status == 'PAID_APPROVED'">
                        <span class="badge badge-success px-2 py-1 mb-1 d-inline-block" style="border-radius: 6px;"><i
                                class="las la-check mr-1"></i> {{ 'Approved' | translate }}</span>
                    </ng-container>
                    <ng-container *ngIf="order.payment_status == 'PAID_REJECTED'">
                        <span class="badge badge-danger px-2 py-1 mb-1 d-inline-block" style="border-radius: 6px;"><i
                                class="las la-times mr-1"></i> {{ 'Rejected' | translate }}</span>
                    </ng-container>

                    <p class="text-muted m-0 mt-1" style="font-size: 0.8rem;"><i class="las la-credit-card mr-1"></i> {{
                        order.method_payment }}</p>

                    <ng-container *ngIf="order.payment_status == 'PAID_REJECTED' && order.rejection_reason">
                        <small class="text-danger d-block mt-1 bg-light p-1 rounded"><i
                                class="las la-info-circle mr-1"></i> {{ order.rejection_reason }}</small>
                    </ng-container>
                </div>

            </div>
        </ng-container>
    </ng-container>

    <ng-template #noOrders>
        <div class="text-center p-5 rounded" style="background: rgba(0,0,0,0.02); border: 1px dashed rgba(0,0,0,0.1);">
            <div class="mb-3">
                <i class="las la-shopping-basket text-muted" style="font-size: 4rem; opacity: 0.5;"></i>
            </div>
            <h5 class="text-muted">{{ 'No orders found' | translate }}</h5>
            <p class="text-sm">{{ 'You have not placed any orders yet.' | translate }}</p>
            <a routerLink="/" class="btn btn-primary mt-3 px-4 py-2" style="border-radius: 8px;">{{ 'Start Shopping' |
                translate }}</a>
        </div>
    </ng-template>
</div>